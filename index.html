<!DOCTYPE html>
<html lang="en">
<head>
    <title>F1 API V2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<!-- navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">
        <img src=API_logo.png alt="Navbar Logo">
    </a>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="#driversnav">Drivers</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#teamsnav">Teams</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#searchnav">Search</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#adminnav">Admin</a>
            </li>
        </ul>
    </div>
</nav>


<div id="app">
    <h2 id="driversnav">Drivers</h2>
    <div class="row">
        <div class="col-md-3" v-for="driver in drivers" :key="driver.id">
            <div class="card mb-3">
                <div class="card-body">
                    <p class="card-title"><strong>Name:</strong> {{ driver.name }}</p>
                    <p class="card-text"><strong>Number:</strong> {{ driver.number }}</p>
                    <p class="card-text"><strong>Nationality:</strong> {{ driver.nationality }}</p>
                </div>
            </div>
        </div>
        <div v-if="drivers.length === 0" class="col-md-12">
            <p class="text-center">There are 0 drivers available.</p>
        </div>
    </div>
    <div class="line"></div>
    <h2 id="teamsnav">Teams</h2>
    <div class="row">
        <div class="col-md-3" v-for="team in teams" :key="team.id">
            <div class="card mb-3">
                <div class="card-body">
                    <p class="card-title"><strong>Name:</strong> {{ team.name }}</p>
                    <p class="card-text"><strong>Country:</strong> {{ team.country }}</p>
                </div>
            </div>
        </div>
        <div v-if="teams.length === 0" class="col-md-12">
            <p class="text-center">There are 0 teams available.</p>
        </div>
    </div>
    <div class="line"></div>
    <h2 id="searchnav">Search</h2>
    dfdfs
    <div class="line"></div>
    <h2 id="adminnav">Admin</h2>
    <div class="row">
    <div class="col-md-6">
        <h4>Add team</h4>
        <form @submit.prevent="addTeam">
            <div class="form-group">
                <label for="teamName">Team Name</label>
                <input type="text" class="form-control" id="teamName" v-model="teamName">
            </div>
            <div class="form-group">
                <label for="teamCountry">Country</label>
                <input type="text" class="form-control" id="teamCountry" v-model="teamCountry">
            </div>
            <button type="submit" class="btn btn-success">Add Team</button>
        </form>
    </div>
    <div class="col-md-6">
        <h4>Add driver</h4>
        <form @submit.prevent="addDriver">
            <div class="form-group">
                <label for="driverNumber">Driver Number</label>
                <input type="number" class="form-control" id="driverNumber" v-model="driverNumber">
            </div>
            <div class="form-group">
                <label for="driverName">Driver Name</label>
                <input type="text" class="form-control" id="driverName" v-model="driverName">
            </div>
            <div class="form-group">
                <label for="driverNationality">Driver Nationality</label>
                <input type="text" class="form-control" id="driverNationality" v-model="driverNationality">
            </div>
            <button type="submit" class="btn btn-success">Add Driver</button>
        </form>
    </div>
</div>

</div>
<script>
    new Vue({
        el: '#app',
        data: {
            drivers: [],
            teams: [],
            teamName: '',
            teamCountry: '',
            driverNumber: '',
            driverName: '',
            driverNationality: ''
        },
        created() {
            this.getData();
        },
        methods: {
            async getData() {
                try {
                    const driversResponse = await fetch('https://f1-api-matscouwenberg.cloud.okteto.net/drivers/');
                    const teamsResponse = await fetch('https://f1-api-matscouwenberg.cloud.okteto.net/teams/');

                    if (driversResponse.ok) {
                        this.drivers = await driversResponse.json();
                    }

                    if (teamsResponse.ok) {
                        this.teams = await teamsResponse.json();
                    }
                } catch (error) {
                    console.error('Error fetching data:', error);
                }
            },
            async addTeam() {
                try {
                    const response = await fetch('https://f1-api-matscouwenberg.cloud.okteto.net/teams/new/', {
                        method: 'POST',
                        body: JSON.stringify({
                            name: this.teamName,
                            country: this.teamCountry
                        }),
                        headers: {
                            'Content-type': 'application/json; charset=UTF-8'
                        }
                    });

                    if (response.ok) {
                        await this.getData();
                        this.teamName = '';
                        this.teamCountry = '';
                    } else {
                        console.error('Failed to add team');
                    }
                } catch (error) {
                    console.error('Error adding team:', error);
                }
            },
            async addDriver() {
                try {
                    const response = await fetch('https://f1-api-matscouwenberg.cloud.okteto.net/drivers/new/', {
                        method: 'POST',
                        body: JSON.stringify({
                            number: this.driverNumber,
                            name: this.driverName,
                            nationality: this.driverNationality
                        }),
                        headers: {
                            'Content-type': 'application/json; charset=UTF-8'
                        }
                    });

                    if (response.ok) {
                        await this.getData();
                        this.driverNumber = '';
                        this.driverName = '';
                        this.driverNationality = '';
                    } else {
                        console.error('Failed to add driver');
                    }
                } catch (error) {
                    console.error('Error adding driver:', error);
                }
            }
        }
    });
</script>
</body>
</html>
